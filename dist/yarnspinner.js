"use strict";(self.webpackChunkyarn_web_runner=self.webpackChunkyarn_web_runner||[]).push([[179],{927:(e,t,n)=>{function r(e){let t=typeof e;if("object"==t){if(Array.isArray(e))return"array";if(null===e)return"null"}return t}function i(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}n.r(t),n.d(t,{BinaryReader:()=>L,BinaryWriter:()=>P,LongType:()=>X,MESSAGE_TYPE:()=>x,MessageType:()=>we,PbLong:()=>S,PbULong:()=>E,ReflectionBinaryReader:()=>ue,ReflectionBinaryWriter:()=>ce,ReflectionJsonReader:()=>oe,ReflectionJsonWriter:()=>ae,ReflectionTypeCheck:()=>ie,RepeatType:()=>H,ScalarType:()=>G,UnknownFieldHandler:()=>f,WireType:()=>h,assert:()=>F,assertFloat32:()=>A,assertInt32:()=>R,assertNever:()=>V,assertUInt32:()=>D,base64decode:()=>a,base64encode:()=>l,binaryReadOptions:()=>U,binaryWriteOptions:()=>C,clearOneofValue:()=>ne,containsMessageType:()=>ye,getOneofValue:()=>ee,getSelectedOneofValue:()=>re,isEnumObject:()=>ke,isJsonObject:()=>i,isOneofGroup:()=>Q,jsonReadOptions:()=>$,jsonWriteOptions:()=>W,listEnumNames:()=>Te,listEnumNumbers:()=>Ie,listEnumValues:()=>Ne,lowerCamelCase:()=>J,mergeBinaryOptions:()=>d,mergeJsonOptions:()=>K,normalizeFieldInfo:()=>Y,readFieldOption:()=>q,readFieldOptions:()=>Z,readMessageOption:()=>z,reflectionCreate:()=>fe,reflectionEquals:()=>de,reflectionMergePartial:()=>he,reflectionScalarDefault:()=>le,setOneofValue:()=>te,typeofJsonValue:()=>r,utf8read:()=>c});let s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),o=[];for(let e=0;e<s.length;e++)o[s[e].charCodeAt(0)]=e;function a(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,r=new Uint8Array(t),i=0,s=0,a=0;for(let t=0;t<e.length;t++){if(n=o[e.charCodeAt(t)],void 0===n)switch(e[t]){case"=":s=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:a=n,s=1;break;case 1:r[i++]=a<<2|(48&n)>>4,a=n,s=2;break;case 2:r[i++]=(15&a)<<4|(60&n)>>2,a=n,s=3;break;case 3:r[i++]=(3&a)<<6|n,s=0}}if(1==s)throw Error("invalid base64 string.");return r.subarray(0,i)}function l(e){let t,n="",r=0,i=0;for(let o=0;o<e.length;o++)switch(t=e[o],r){case 0:n+=s[t>>2],i=(3&t)<<4,r=1;break;case 1:n+=s[i|t>>4],i=(15&t)<<2,r=2;break;case 2:n+=s[i|t>>6],n+=s[63&t],r=0}return r&&(n+=s[i],n+="=",1==r&&(n+="=")),n}o["-".charCodeAt(0)]=s.indexOf("+"),o["_".charCodeAt(0)]=s.indexOf("/");const u=e=>String.fromCharCode.apply(String,e);function c(e){if(e.length<1)return"";let t,n=0,r=[],i=[],s=0,o=e.length;for(;n<o;)t=e[n++],t<128?i[s++]=t:t>191&&t<224?i[s++]=(31&t)<<6|63&e[n++]:t>239&&t<365?(t=((7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,i[s++]=55296+(t>>10),i[s++]=56320+(1023&t)):i[s++]=(15&t)<<12|(63&e[n++])<<6|63&e[n++],s>8191&&(r.push(u(i)),s=0);return r.length?(s&&r.push(u(i.slice(0,s))),r.join("")):u(i.slice(0,s))}var f,h;function d(e,t){return Object.assign(Object.assign({},e),t)}function p(){let e=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(e|=(127&r)<<n,0==(128&r))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(127&r)<<n,0==(128&r))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function g(e,t,n){for(let r=0;r<28;r+=7){const i=e>>>r,s=!(i>>>7==0&&0==t),o=255&(s?128|i:i);if(n.push(o),!s)return}const r=e>>>28&15|(7&t)<<4,i=!(t>>3==0);if(n.push(255&(i?128|r:r)),i){for(let e=3;e<31;e+=7){const r=t>>>e,i=!(r>>>7==0),s=255&(i?128|r:r);if(n.push(s),!i)return}n.push(t>>>31&1)}}!function(e){e.symbol=Symbol.for("protobuf-ts/unknown"),e.onRead=(n,r,i,s,o)=>{(t(r)?r[e.symbol]:r[e.symbol]=[]).push({no:i,wireType:s,data:o})},e.onWrite=(t,n,r)=>{for(let{no:t,wireType:i,data:s}of e.list(n))r.tag(t,i).raw(s)},e.list=(n,r)=>{if(t(n)){let t=n[e.symbol];return r?t.filter((e=>e.no==r)):t}return[]},e.last=(t,n)=>e.list(t,n).slice(-1)[0];const t=t=>t&&Array.isArray(t[e.symbol])}(f||(f={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(h||(h={}));const m=4294967296;function b(e){let t="-"==e[0];t&&(e=e.slice(1));const n=1e6;let r=0,i=0;function s(t,s){const o=Number(e.slice(t,s));i*=n,r=r*n+o,r>=m&&(i+=r/m|0,r%=m)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),[t,r,i]}function w(e,t){if(t<=2097151)return""+(m*t+e);let n=(e>>>24|t<<8)>>>0&16777215,r=t>>16&65535,i=(16777215&e)+6777216*n+6710656*r,s=n+8147497*r,o=2*r,a=1e7;function l(e,t){let n=e?String(e):"";return t?"0000000".slice(n.length)+n:n}return i>=a&&(s+=Math.floor(i/a),i%=a),s>=a&&(o+=Math.floor(s/a),s%=a),l(o,0)+l(s,o)+l(i,1)}function y(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function k(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;0!=(128&e)&&t<10;t++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}const N=function(){const e=new DataView(new ArrayBuffer(8));return void 0!==globalThis.BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:e}:void 0}();function T(e){if(!e)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}const I=/^-?[0-9]+$/,v=4294967296;class O{constructor(e,t){this.lo=0|e,this.hi=0|t}isZero(){return 0==this.lo&&0==this.hi}toNumber(){let e=this.hi*v+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}class E extends O{static from(e){if(N)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=N.C(e);case"number":if(0===e)return this.ZERO;e=N.C(e);case"bigint":if(!e)return this.ZERO;if(e<N.UMIN)throw new Error("signed value for ulong");if(e>N.UMAX)throw new Error("ulong too large");return N.V.setBigUint64(0,e,!0),new E(N.V.getInt32(0,!0),N.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!I.test(e))throw new Error("string is no integer");let[t,n,r]=b(e);if(t)throw new Error("signed value");return new E(n,r);case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new E(e,e/v)}throw new Error("unknown value "+typeof e)}toString(){return N?this.toBigInt().toString():w(this.lo,this.hi)}toBigInt(){return T(N),N.V.setInt32(0,this.lo,!0),N.V.setInt32(4,this.hi,!0),N.V.getBigUint64(0,!0)}}E.ZERO=new E(0,0);class S extends O{static from(e){if(N)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=N.C(e);case"number":if(0===e)return this.ZERO;e=N.C(e);case"bigint":if(!e)return this.ZERO;if(e<N.MIN)throw new Error("ulong too small");if(e>N.MAX)throw new Error("ulong too large");return N.V.setBigInt64(0,e,!0),new S(N.V.getInt32(0,!0),N.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!I.test(e))throw new Error("string is no integer");let[t,n,r]=b(e),i=new S(n,r);return t?i.negate():i;case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new S(e,e/v):new S(-e,-e/v).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return 0!=(2147483648&this.hi)}negate(){let e=~this.hi,t=this.lo;return t?t=1+~t:e+=1,new S(t,e)}toString(){if(N)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+w(e.lo,e.hi)}return w(this.lo,this.hi)}toBigInt(){return T(N),N.V.setInt32(0,this.lo,!0),N.V.setInt32(4,this.hi,!0),N.V.getBigInt64(0,!0)}}S.ZERO=new S(0,0);const B={readUnknownField:!0,readerFactory:e=>new L(e)};function U(e){return e?Object.assign(Object.assign({},B),e):B}class L{constructor(e,t){this.varint64=p,this.uint32=k,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder("utf-8",{fatal:!0})}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e){let t=this.pos;switch(e){case h.Varint:for(;128&this.buf[this.pos++];);break;case h.Bit64:this.pos+=4;case h.Bit32:this.pos+=4;break;case h.LengthDelimited:let t=this.uint32();this.pos+=t;break;case h.StartGroup:let n;for(;(n=this.tag()[1])!==h.EndGroup;)this.skip(n);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return new S(...this.varint64())}uint64(){return new E(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,new S(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new E(this.sfixed32(),this.sfixed32())}sfixed64(){return new S(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function F(e,t){if(!e)throw new Error(t)}function V(e,t){throw new Error(null!=t?t:"Unexpected object: "+e)}function R(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function D(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function A(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const _={writeUnknownFields:!0,writerFactory:()=>new P};function C(e){return e?Object.assign(Object.assign({},_),e):_}class P{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(D(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return R(e),y(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){A(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){D(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){R(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return R(e),y(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=S.from(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=E.from(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=S.from(e);return g(t.lo,t.hi,this.buf),this}sint64(e){let t=S.from(e),n=t.hi>>31;return g(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=E.from(e);return g(t.lo,t.hi,this.buf),this}}const M={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},j={ignoreUnknownFields:!1};function $(e){return e?Object.assign(Object.assign({},j),e):j}function W(e){return e?Object.assign(Object.assign({},M),e):M}function K(e,t){var n,r;let i=Object.assign(Object.assign({},e),t);return i.typeRegistry=[...null!==(n=null==e?void 0:e.typeRegistry)&&void 0!==n?n:[],...null!==(r=null==t?void 0:t.typeRegistry)&&void 0!==r?r:[]],i}const x=Symbol.for("protobuf-ts/message-type");function J(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let i=e.charAt(r);"_"==i?t=!0:/\d/.test(i)?(n.push(i),t=!0):t?(n.push(i.toUpperCase()),t=!1):0==r?n.push(i.toLowerCase()):n.push(i)}return n.join("")}var G,X,H;function Y(e){var t,n,r,i;return e.localName=null!==(t=e.localName)&&void 0!==t?t:J(e.name),e.jsonName=null!==(n=e.jsonName)&&void 0!==n?n:J(e.name),e.repeat=null!==(r=e.repeat)&&void 0!==r?r:H.NO,e.opt=null!==(i=e.opt)&&void 0!==i?i:!e.repeat&&!e.oneof&&"message"==e.kind,e}function Z(e,t,n,r){var i;const s=null===(i=e.fields.find(((e,n)=>e.localName==t||n==t)))||void 0===i?void 0:i.options;return s&&s[n]?r.fromJson(s[n]):void 0}function q(e,t,n,r){var i;const s=null===(i=e.fields.find(((e,n)=>e.localName==t||n==t)))||void 0===i?void 0:i.options;if(!s)return;const o=s[n];return void 0===o?o:r?r.fromJson(o):o}function z(e,t,n){const r=e.options[t];return void 0===r?r:n?n.fromJson(r):r}function Q(e){if("object"!=typeof e||null===e||!e.hasOwnProperty("oneofKind"))return!1;switch(typeof e.oneofKind){case"string":return void 0!==e[e.oneofKind]&&2==Object.keys(e).length;case"undefined":return 1==Object.keys(e).length;default:return!1}}function ee(e,t){return e[t]}function te(e,t,n){void 0!==e.oneofKind&&delete e[e.oneofKind],e.oneofKind=t,void 0!==n&&(e[t]=n)}function ne(e){void 0!==e.oneofKind&&delete e[e.oneofKind],e.oneofKind=void 0}function re(e){if(void 0!==e.oneofKind)return e[e.oneofKind]}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(G||(G={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"}(X||(X={})),function(e){e[e.NO=0]="NO",e[e.PACKED=1]="PACKED",e[e.UNPACKED=2]="UNPACKED"}(H||(H={}));class ie{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}prepare(){if(this.data)return;const e=[],t=[],n=[];for(let r of this.fields)if(r.oneof)n.includes(r.oneof)||(n.push(r.oneof),e.push(r.oneof),t.push(r.oneof));else switch(t.push(r.localName),r.kind){case"scalar":case"enum":r.opt&&!r.repeat||e.push(r.localName);break;case"message":r.repeat&&e.push(r.localName);break;case"map":e.push(r.localName)}this.data={req:e,known:t,oneofs:Object.values(n)}}is(e,t,n=!1){if(t<0)return!0;if(null==e||"object"!=typeof e)return!1;this.prepare();let r=Object.keys(e),i=this.data;if(r.length<i.req.length||i.req.some((e=>!r.includes(e))))return!1;if(!n&&r.some((e=>!i.known.includes(e))))return!1;if(t<1)return!0;for(const r of i.oneofs){const i=e[r];if(!Q(i))return!1;if(void 0===i.oneofKind)continue;const s=this.fields.find((e=>e.localName===i.oneofKind));if(!s)return!1;if(!this.field(i[i.oneofKind],s,n,t))return!1}for(const r of this.fields)if(void 0===r.oneof&&!this.field(e[r.localName],r,n,t))return!1;return!0}field(e,t,n,r){let i=t.repeat;switch(t.kind){case"scalar":return void 0===e?t.opt:i?this.scalars(e,t.T,r,t.L):this.scalar(e,t.T,t.L);case"enum":return void 0===e?t.opt:i?this.scalars(e,G.INT32,r):this.scalar(e,G.INT32);case"message":return void 0===e||(i?this.messages(e,t.T(),n,r):this.message(e,t.T(),n,r));case"map":if("object"!=typeof e||null===e)return!1;if(r<2)return!0;if(!this.mapKeys(e,t.K,r))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,r,t.V.L);case"enum":return this.scalars(Object.values(e),G.INT32,r);case"message":return this.messages(Object.values(e),t.V.T(),n,r)}}return!0}message(e,t,n,r){return n?t.isAssignable(e,r):t.is(e,r)}messages(e,t,n,r){if(!Array.isArray(e))return!1;if(r<2)return!0;if(n){for(let n=0;n<e.length&&n<r;n++)if(!t.isAssignable(e[n],r-1))return!1}else for(let n=0;n<e.length&&n<r;n++)if(!t.is(e[n],r-1))return!1;return!0}scalar(e,t,n){let r=typeof e;switch(t){case G.UINT64:case G.FIXED64:case G.INT64:case G.SFIXED64:case G.SINT64:switch(n){case X.BIGINT:return"bigint"==r;case X.NUMBER:return"number"==r&&!isNaN(e);default:return"string"==r}case G.BOOL:return"boolean"==r;case G.STRING:return"string"==r;case G.BYTES:return e instanceof Uint8Array;case G.DOUBLE:case G.FLOAT:return"number"==r&&!isNaN(e);default:return"number"==r&&Number.isInteger(e)}}scalars(e,t,n,r){if(!Array.isArray(e))return!1;if(n<2)return!0;if(Array.isArray(e))for(let i=0;i<e.length&&i<n;i++)if(!this.scalar(e[i],t,r))return!1;return!0}mapKeys(e,t,n){let r=Object.keys(e);switch(t){case G.INT32:case G.FIXED32:case G.SFIXED32:case G.SINT32:case G.UINT32:return this.scalars(r.slice(0,n).map((e=>parseInt(e))),t,n);case G.BOOL:return this.scalars(r.slice(0,n).map((e=>"true"==e||"false"!=e&&e)),t,n);default:return this.scalars(r,t,n,X.STRING)}}}function se(e,t){switch(t){case X.BIGINT:return e.toBigInt();case X.NUMBER:return e.toNumber();default:return e.toString()}}class oe{constructor(e){this.info=e}prepare(){var e;if(void 0===this.fMap){this.fMap={};const t=null!==(e=this.info.fields)&&void 0!==e?e:[];for(const e of t)this.fMap[e.name]=e,this.fMap[e.jsonName]=e,this.fMap[e.localName]=e}}assert(e,t,n){if(!e){let e=r(n);throw"number"!=e&&"boolean"!=e||(e=n.toString()),new Error(`Cannot parse JSON ${e} for ${this.info.typeName}#${t}`)}}read(e,t,n){this.prepare();const r=[];for(const[s,o]of Object.entries(e)){const e=this.fMap[s];if(!e){if(!n.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${s}`);continue}const a=e.localName;let l;if(e.oneof){if(r.includes(e.oneof))throw new Error(`Multiple members of the oneof group "${e.oneof}" of ${this.info.typeName} are present in JSON.`);r.push(e.oneof),l=t[e.oneof]={oneofKind:a}}else l=t;if("map"==e.kind){if(null===o)continue;this.assert(i(o),e.name,o);const t=l[a];for(const[r,i]of Object.entries(o)){let s;switch(this.assert(null!==i,e.name+" map value",null),e.V.kind){case"message":s=e.V.T().internalJsonRead(i,n);break;case"enum":if(s=this.enum(e.V.T(),i,e.name,n.ignoreUnknownFields),!1===s)continue;break;case"scalar":s=this.scalar(i,e.V.T,e.V.L,e.name)}this.assert(void 0!==s,e.name+" map value",i);let o=r;e.K==G.BOOL&&(o="true"==o||"false"!=o&&o),o=this.scalar(o,e.K,X.STRING,e.name).toString(),t[o]=s}}else if(e.repeat){if(null===o)continue;this.assert(Array.isArray(o),e.name,o);const t=l[a];for(const r of o){let i;switch(this.assert(null!==r,e.name,null),e.kind){case"message":i=e.T().internalJsonRead(r,n);break;case"enum":if(i=this.enum(e.T(),r,e.name,n.ignoreUnknownFields),!1===i)continue;break;case"scalar":i=this.scalar(r,e.T,e.L,e.name)}this.assert(void 0!==i,e.name,o),t.push(i)}}else switch(e.kind){case"message":if(null===o&&"google.protobuf.Value"!=e.T().typeName){this.assert(void 0===e.oneof,e.name+" (oneof member)",null);continue}l[a]=e.T().internalJsonRead(o,n,l[a]);break;case"enum":let t=this.enum(e.T(),o,e.name,n.ignoreUnknownFields);if(!1===t)continue;l[a]=t;break;case"scalar":l[a]=this.scalar(o,e.T,e.L,e.name)}}}enum(e,t,n,r){if("google.protobuf.NullValue"==e[0]&&F(null===t,`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} only accepts null.`),null===t)return 0;switch(typeof t){case"number":return F(Number.isInteger(t),`Unable to parse field ${this.info.typeName}#${n}, enum can only be integral number, got ${t}.`),t;case"string":let i=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(i=t.substring(e[2].length));let s=e[1][i];return(void 0!==s||!r)&&(F("number"==typeof s,`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} has no value for "${t}".`),s)}F(!1,`Unable to parse field ${this.info.typeName}#${n}, cannot parse enum value from ${typeof t}".`)}scalar(e,t,n,r){let i;try{switch(t){case G.DOUBLE:case G.FLOAT:if(null===e)return 0;if("NaN"===e)return Number.NaN;if("Infinity"===e)return Number.POSITIVE_INFINITY;if("-Infinity"===e)return Number.NEGATIVE_INFINITY;if(""===e){i="empty string";break}if("string"==typeof e&&e.trim().length!==e.length){i="extra whitespace";break}if("string"!=typeof e&&"number"!=typeof e)break;let r=Number(e);if(Number.isNaN(r)){i="not a number";break}if(!Number.isFinite(r)){i="too large or small";break}return t==G.FLOAT&&A(r),r;case G.INT32:case G.FIXED32:case G.SFIXED32:case G.SINT32:case G.UINT32:if(null===e)return 0;let s;if("number"==typeof e?s=e:""===e?i="empty string":"string"==typeof e&&(e.trim().length!==e.length?i="extra whitespace":s=Number(e)),void 0===s)break;return t==G.UINT32?D(s):R(s),s;case G.INT64:case G.SFIXED64:case G.SINT64:if(null===e)return se(S.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return se(S.from(e),n);case G.FIXED64:case G.UINT64:if(null===e)return se(E.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return se(E.from(e),n);case G.BOOL:if(null===e)return!1;if("boolean"!=typeof e)break;return e;case G.STRING:if(null===e)return"";if("string"!=typeof e){i="extra whitespace";break}try{encodeURIComponent(e)}catch(i){i="invalid UTF8";break}return e;case G.BYTES:if(null===e||""===e)return new Uint8Array(0);if("string"!=typeof e)break;return a(e)}}catch(e){i=e.message}this.assert(!1,r+(i?" - "+i:""),e)}}class ae{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}write(e,t){const n={},r=e;for(const e of this.fields){if(!e.oneof){let i=this.field(e,r[e.localName],t);void 0!==i&&(n[t.useProtoFieldName?e.name:e.jsonName]=i);continue}const i=r[e.oneof];if(i.oneofKind!==e.localName)continue;const s="scalar"==e.kind||"enum"==e.kind?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t;let o=this.field(e,i[e.localName],s);F(void 0!==o),n[t.useProtoFieldName?e.name:e.jsonName]=o}return n}field(e,t,n){let r;if("map"==e.kind){F("object"==typeof t&&null!==t);const i={};switch(e.V.kind){case"scalar":for(const[n,r]of Object.entries(t)){const t=this.scalar(e.V.T,r,e.name,!1,!0);F(void 0!==t),i[n.toString()]=t}break;case"message":const r=e.V.T();for(const[s,o]of Object.entries(t)){const t=this.message(r,o,e.name,n);F(void 0!==t),i[s.toString()]=t}break;case"enum":const s=e.V.T();for(const[r,o]of Object.entries(t)){F(void 0===o||"number"==typeof o);const t=this.enum(s,o,e.name,!1,!0,n.enumAsInteger);F(void 0!==t),i[r.toString()]=t}}(n.emitDefaultValues||Object.keys(i).length>0)&&(r=i)}else if(e.repeat){F(Array.isArray(t));const i=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++){const r=this.scalar(e.T,t[n],e.name,e.opt,!0);F(void 0!==r),i.push(r)}break;case"enum":const r=e.T();for(let s=0;s<t.length;s++){F(void 0===t[s]||"number"==typeof t[s]);const o=this.enum(r,t[s],e.name,e.opt,!0,n.enumAsInteger);F(void 0!==o),i.push(o)}break;case"message":const s=e.T();for(let r=0;r<t.length;r++){const o=this.message(s,t[r],e.name,n);F(void 0!==o),i.push(o)}}(n.emitDefaultValues||i.length>0||n.emitDefaultValues)&&(r=i)}else switch(e.kind){case"scalar":r=this.scalar(e.T,t,e.name,e.opt,n.emitDefaultValues);break;case"enum":r=this.enum(e.T(),t,e.name,e.opt,n.emitDefaultValues,n.enumAsInteger);break;case"message":r=this.message(e.T(),t,e.name,n)}return r}enum(e,t,n,r,i,s){if("google.protobuf.NullValue"==e[0])return null;if(void 0!==t){if(0!==t||i||r)return F("number"==typeof t),F(Number.isInteger(t)),s||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}else F(r)}message(e,t,n,r){return void 0===t?r.emitDefaultValues?null:void 0:e.internalJsonWrite(t,r)}scalar(e,t,n,r,i){if(void 0===t)return void F(r);const s=i||r;switch(e){case G.INT32:case G.SFIXED32:case G.SINT32:return 0===t?s?0:void 0:(R(t),t);case G.FIXED32:case G.UINT32:return 0===t?s?0:void 0:(D(t),t);case G.FLOAT:A(t);case G.DOUBLE:return 0===t?s?0:void 0:(F("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case G.STRING:return""===t?s?"":void 0:(F("string"==typeof t),t);case G.BOOL:return!1===t?!s&&void 0:(F("boolean"==typeof t),t);case G.UINT64:case G.FIXED64:F("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let e=E.from(t);if(e.isZero()&&!s)return;return e.toString();case G.INT64:case G.SFIXED64:case G.SINT64:F("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let n=S.from(t);if(n.isZero()&&!s)return;return n.toString();case G.BYTES:return F(t instanceof Uint8Array),t.byteLength?l(t):s?"":void 0}}}function le(e,t=X.STRING){switch(e){case G.BOOL:return!1;case G.UINT64:case G.FIXED64:return se(E.ZERO,t);case G.INT64:case G.SFIXED64:case G.SINT64:return se(S.ZERO,t);case G.DOUBLE:case G.FLOAT:return 0;case G.BYTES:return new Uint8Array(0);case G.STRING:return"";default:return 0}}class ue{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){const t=null!==(e=this.info.fields)&&void 0!==e?e:[];this.fieldNoToField=new Map(t.map((e=>[e.no,e])))}}read(e,t,n,r){this.prepare();const i=void 0===r?e.len:e.pos+r;for(;e.pos<i;){const[r,i]=e.tag(),s=this.fieldNoToField.get(r);if(!s){let s=n.readUnknownField;if("throw"==s)throw new Error(`Unknown field ${r} (wire type ${i}) for ${this.info.typeName}`);let o=e.skip(i);!1!==s&&(!0===s?f.onRead:s)(this.info.typeName,t,r,i,o);continue}let o=t,a=s.repeat,l=s.localName;switch(s.oneof&&(o=o[s.oneof],o.oneofKind!==l&&(o=t[s.oneof]={oneofKind:l})),s.kind){case"scalar":case"enum":let t="enum"==s.kind?G.INT32:s.T,r="scalar"==s.kind?s.L:void 0;if(a){let n=o[l];if(i==h.LengthDelimited&&t!=G.STRING&&t!=G.BYTES){let i=e.uint32()+e.pos;for(;e.pos<i;)n.push(this.scalar(e,t,r))}else n.push(this.scalar(e,t,r))}else o[l]=this.scalar(e,t,r);break;case"message":if(a){let t=o[l],r=s.T().internalBinaryRead(e,e.uint32(),n);t.push(r)}else o[l]=s.T().internalBinaryRead(e,e.uint32(),n,o[l]);break;case"map":let[u,c]=this.mapEntry(s,e,n);o[l][u]=c}}}mapEntry(e,t,n){let r,i,s=t.uint32(),o=t.pos+s;for(;t.pos<o;){let[s,o]=t.tag();switch(s){case 1:r=e.K==G.BOOL?t.bool().toString():this.scalar(t,e.K,X.STRING);break;case 2:switch(e.V.kind){case"scalar":i=this.scalar(t,e.V.T,e.V.L);break;case"enum":i=t.int32();break;case"message":i=e.V.T().internalBinaryRead(t,t.uint32(),n)}break;default:throw new Error(`Unknown field ${s} (wire type ${o}) in map entry for ${this.info.typeName}#${e.name}`)}}if(void 0===r){let t=le(e.K);r=e.K==G.BOOL?t.toString():t}if(void 0===i)switch(e.V.kind){case"scalar":i=le(e.V.T,e.V.L);break;case"enum":i=0;break;case"message":i=e.V.T().create()}return[r,i]}scalar(e,t,n){switch(t){case G.INT32:return e.int32();case G.STRING:return e.string();case G.BOOL:return e.bool();case G.DOUBLE:return e.double();case G.FLOAT:return e.float();case G.INT64:return se(e.int64(),n);case G.UINT64:return se(e.uint64(),n);case G.FIXED64:return se(e.fixed64(),n);case G.FIXED32:return e.fixed32();case G.BYTES:return e.bytes();case G.UINT32:return e.uint32();case G.SFIXED32:return e.sfixed32();case G.SFIXED64:return se(e.sfixed64(),n);case G.SINT32:return e.sint32();case G.SINT64:return se(e.sint64(),n)}}}class ce{constructor(e){this.info=e}prepare(){if(!this.fields){const e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort(((e,t)=>e.no-t.no))}}write(e,t,n){this.prepare();for(const r of this.fields){let i,s,o=r.repeat,a=r.localName;if(r.oneof){const t=e[r.oneof];if(t.oneofKind!==a)continue;i=t[a],s=!0}else i=e[a],s=!1;switch(r.kind){case"scalar":case"enum":let e="enum"==r.kind?G.INT32:r.T;if(o)if(F(Array.isArray(i)),o==H.PACKED)this.packed(t,e,r.no,i);else for(const n of i)this.scalar(t,e,r.no,n,!0);else void 0===i?F(r.opt):this.scalar(t,e,r.no,i,s||r.opt);break;case"message":if(o){F(Array.isArray(i));for(const e of i)this.message(t,n,r.T(),r.no,e)}else this.message(t,n,r.T(),r.no,i);break;case"map":F("object"==typeof i&&null!==i);for(const[e,s]of Object.entries(i))this.mapEntry(t,n,r,e,s)}}let r=n.writeUnknownFields;!1!==r&&(!0===r?f.onWrite:r)(this.info.typeName,e,t)}mapEntry(e,t,n,r,i){e.tag(n.no,h.LengthDelimited),e.fork();let s=r;switch(n.K){case G.INT32:case G.FIXED32:case G.UINT32:case G.SFIXED32:case G.SINT32:s=Number.parseInt(r);break;case G.BOOL:F("true"==r||"false"==r),s="true"==r}switch(this.scalar(e,n.K,1,s,!0),n.V.kind){case"scalar":this.scalar(e,n.V.T,2,i,!0);break;case"enum":this.scalar(e,G.INT32,2,i,!0);break;case"message":this.message(e,t,n.V.T(),2,i)}e.join()}message(e,t,n,r,i){void 0!==i&&(n.internalBinaryWrite(i,e.tag(r,h.LengthDelimited).fork(),t),e.join())}scalar(e,t,n,r,i){let[s,o,a]=this.scalarInfo(t,r);a&&!i||(e.tag(n,s),e[o](r))}packed(e,t,n,r){if(!r.length)return;F(t!==G.BYTES&&t!==G.STRING),e.tag(n,h.LengthDelimited),e.fork();let[,i]=this.scalarInfo(t);for(let t=0;t<r.length;t++)e[i](r[t]);e.join()}scalarInfo(e,t){let n,r=h.Varint,i=void 0===t,s=0===t;switch(e){case G.INT32:n="int32";break;case G.STRING:s=i||!t.length,r=h.LengthDelimited,n="string";break;case G.BOOL:s=!1===t,n="bool";break;case G.UINT32:n="uint32";break;case G.DOUBLE:r=h.Bit64,n="double";break;case G.FLOAT:r=h.Bit32,n="float";break;case G.INT64:s=i||S.from(t).isZero(),n="int64";break;case G.UINT64:s=i||E.from(t).isZero(),n="uint64";break;case G.FIXED64:s=i||E.from(t).isZero(),r=h.Bit64,n="fixed64";break;case G.BYTES:s=i||!t.byteLength,r=h.LengthDelimited,n="bytes";break;case G.FIXED32:r=h.Bit32,n="fixed32";break;case G.SFIXED32:r=h.Bit32,n="sfixed32";break;case G.SFIXED64:s=i||S.from(t).isZero(),r=h.Bit64,n="sfixed64";break;case G.SINT32:n="sint32";break;case G.SINT64:s=i||S.from(t).isZero(),n="sint64"}return[r,n,i||s]}}function fe(e){const t={};Object.defineProperty(t,x,{enumerable:!1,value:e});for(let n of e.fields){let e=n.localName;if(!n.opt)if(n.oneof)t[n.oneof]={oneofKind:void 0};else if(n.repeat)t[e]=[];else switch(n.kind){case"scalar":t[e]=le(n.T,n.L);break;case"enum":t[e]=0;break;case"map":t[e]={}}}return t}function he(e,t,n){let r,i,s=n;for(let n of e.fields){let e=n.localName;if(n.oneof){const o=s[n.oneof];if(void 0===o)continue;if(r=o[e],i=t[n.oneof],i.oneofKind=o.oneofKind,void 0===r){delete i[e];continue}}else if(r=s[e],i=t,void 0===r)continue;switch(n.kind){case"scalar":case"enum":n.repeat?i[e]=r.concat():i[e]=r;break;case"message":let t=n.T();if(n.repeat)for(let n=0;n<r.length;n++)i[e][n]=t.create(r[n]);else void 0===i[e]?i[e]=t.create(r):t.mergePartial(i[e],r);break;case"map":switch(n.V.kind){case"scalar":case"enum":Object.assign(i[e],r);break;case"message":let t=n.V.T();for(let n of Object.keys(r))i[e][n]=t.create(r[n])}}}}function de(e,t,n){if(t===n)return!0;if(!t||!n)return!1;for(let r of e.fields){let e=r.localName,i=r.oneof?t[r.oneof][e]:t[e],s=r.oneof?n[r.oneof][e]:n[e];switch(r.kind){case"enum":case"scalar":let e="enum"==r.kind?G.INT32:r.T;if(!(r.repeat?me(e,i,s):ge(e,i,s)))return!1;break;case"map":if(!("message"==r.V.kind?be(r.V.T(),pe(i),pe(s)):me("enum"==r.V.kind?G.INT32:r.V.T,pe(i),pe(s))))return!1;break;case"message":let t=r.T();if(!(r.repeat?be(t,i,s):t.equals(i,s)))return!1}}return!0}const pe=Object.values;function ge(e,t,n){if(t===n)return!0;if(e!==G.BYTES)return!1;let r=t,i=n;if(r.length!==i.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!=i[e])return!1;return!0}function me(e,t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!ge(e,t[r],n[r]))return!1;return!0}function be(e,t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e.equals(t[r],n[r]))return!1;return!0}class we{constructor(e,t,n){this.defaultCheckDepth=16,this.typeName=e,this.fields=t.map(Y),this.options=null!=n?n:{},this.refTypeCheck=new ie(this),this.refJsonReader=new oe(this),this.refJsonWriter=new ae(this),this.refBinReader=new ue(this),this.refBinWriter=new ce(this)}create(e){let t=fe(this);return void 0!==e&&he(this,t,e),t}clone(e){let t=this.create();return he(this,t,e),t}equals(e,t){return de(this,e,t)}is(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!1)}isAssignable(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!0)}mergePartial(e,t){he(this,e,t)}fromBinary(e,t){let n=U(t);return this.internalBinaryRead(n.readerFactory(e),e.byteLength,n)}fromJson(e,t){return this.internalJsonRead(e,$(t))}fromJsonString(e,t){let n=JSON.parse(e);return this.fromJson(n,t)}toJson(e,t){return this.internalJsonWrite(e,W(t))}toJsonString(e,t){var n;let r=this.toJson(e,t);return JSON.stringify(r,null,null!==(n=null==t?void 0:t.prettySpaces)&&void 0!==n?n:0)}toBinary(e,t){let n=C(t);return this.internalBinaryWrite(e,n.writerFactory(),n).finish()}internalJsonRead(e,t,n){if(null!==e&&"object"==typeof e&&!Array.isArray(e)){let r=null!=n?n:this.create();return this.refJsonReader.read(e,r,t),r}throw new Error(`Unable to parse message ${this.typeName} from JSON ${r(e)}.`)}internalJsonWrite(e,t){return this.refJsonWriter.write(e,t)}internalBinaryWrite(e,t,n){return this.refBinWriter.write(e,t,n),t}internalBinaryRead(e,t,n,r){let i=null!=r?r:this.create();return this.refBinReader.read(e,i,n,t),i}}function ye(e){return null!=e[x]}function ke(e){if("object"!=typeof e||null===e)return!1;if(!e.hasOwnProperty(0))return!1;for(let t of Object.keys(e)){let n=parseInt(t);if(Number.isNaN(n)){let n=e[t];if(void 0===n)return!1;if("number"!=typeof n)return!1;if(void 0===e[n])return!1}else{let t=e[n];if(void 0===t)return!1;if(e[t]!==n)return!1}}return!0}function Ne(e){if(!ke(e))throw new Error("not a typescript enum object");let t=[];for(let[n,r]of Object.entries(e))"number"==typeof r&&t.push({name:n,number:r});return t}function Te(e){return Ne(e).map((e=>e.name))}function Ie(e){return Ne(e).map((e=>e.number)).filter(((e,t,n)=>n.indexOf(e)==t))}},138:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;const i=n(471),s=n(683),o=n(137);function a(e,t){let n=o.Program.fromBinary(t);if(null==n)console.log("well poop");else{var r=new s.YarnVM(n,e);r.setNode("Start")?(r.lineCallback=function(e){return new Promise((function(t){var n,r=document.createElement("div");r.innerHTML=`<p>${e}</p>`,null===(n=document.getElementById("container"))||void 0===n||n.appendChild(r),t()}))},r.commandCallback=function(e){return new Promise((function(t){var n,r=document.createElement("div");r.innerHTML=`<p><i>${e}</i></p>`,null===(n=document.getElementById("container"))||void 0===n||n.appendChild(r),t()}))},r.optionCallback=function(e){return new Promise((function(t){var n,r=document.createElement("div");e.forEach(((e,n)=>{var i=document.createElement("p");i.innerHTML=`<b>-></b> ${e.line}`,r.appendChild(i);var s=document.createElement("button");s.innerHTML="Select",s.classList.add("optionButton"),r.appendChild(s),s.addEventListener("click",(()=>{document.querySelectorAll(".optionButton").forEach((e=>{e.remove()})),t(n)}))})),null===(n=document.getElementById("container"))||void 0===n||n.appendChild(r)}))},r.start()):console.error("shit")}}window.addEventListener("load",(function(){var e;return r(this,void 0,void 0,(function*(){console.log("window loaded!"),null===(e=this.document.getElementById("testbutton"))||void 0===e||e.addEventListener("click",(()=>{let e=this.document.getElementById("container");null!=e&&(e.innerHTML=""),a(i.stringTable,i.data)}))}))})),t.load=a},137:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Operand=t.Instruction=t.Node=t.Program=t.Instruction_OpCode=void 0;const r=n(927),i=n(927),s=n(927),o=n(927),a=n(927);var l;!function(e){e[e.JUMP_TO=0]="JUMP_TO",e[e.JUMP=1]="JUMP",e[e.RUN_LINE=2]="RUN_LINE",e[e.RUN_COMMAND=3]="RUN_COMMAND",e[e.ADD_OPTION=4]="ADD_OPTION",e[e.SHOW_OPTIONS=5]="SHOW_OPTIONS",e[e.PUSH_STRING=6]="PUSH_STRING",e[e.PUSH_FLOAT=7]="PUSH_FLOAT",e[e.PUSH_BOOL=8]="PUSH_BOOL",e[e.PUSH_NULL=9]="PUSH_NULL",e[e.JUMP_IF_FALSE=10]="JUMP_IF_FALSE",e[e.POP=11]="POP",e[e.CALL_FUNC=12]="CALL_FUNC",e[e.PUSH_VARIABLE=13]="PUSH_VARIABLE",e[e.STORE_VARIABLE=14]="STORE_VARIABLE",e[e.STOP=15]="STOP",e[e.RUN_NODE=16]="RUN_NODE"}(l=t.Instruction_OpCode||(t.Instruction_OpCode={}));class u extends a.MessageType{constructor(){super("Yarn.Program",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"nodes",kind:"map",K:9,V:{kind:"message",T:()=>t.Node}},{no:3,name:"initial_values",kind:"map",K:9,V:{kind:"message",T:()=>t.Operand}}])}create(e){const t={name:"",nodes:{},initialValues:{}};return globalThis.Object.defineProperty(t,o.MESSAGE_TYPE,{enumerable:!1,value:this}),void 0!==e&&(0,s.reflectionMergePartial)(this,t,e),t}internalBinaryRead(e,t,n,r){let s=null!=r?r:this.create(),o=e.pos+t;for(;e.pos<o;){let[t,r]=e.tag();switch(t){case 1:s.name=e.string();break;case 2:this.binaryReadMap2(s.nodes,e,n);break;case 3:this.binaryReadMap3(s.initialValues,e,n);break;default:let o=n.readUnknownField;if("throw"===o)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let a=e.skip(r);!1!==o&&(!0===o?i.UnknownFieldHandler.onRead:o)(this.typeName,s,t,r,a)}}return s}binaryReadMap2(e,n,r){let i,s,o=n.uint32(),a=n.pos+o;for(;n.pos<a;){let[e,o]=n.tag();switch(e){case 1:i=n.string();break;case 2:s=t.Node.internalBinaryRead(n,n.uint32(),r);break;default:throw new globalThis.Error("unknown map entry field for field Yarn.Program.nodes")}}e[null!=i?i:""]=null!=s?s:t.Node.create()}binaryReadMap3(e,n,r){let i,s,o=n.uint32(),a=n.pos+o;for(;n.pos<a;){let[e,o]=n.tag();switch(e){case 1:i=n.string();break;case 2:s=t.Operand.internalBinaryRead(n,n.uint32(),r);break;default:throw new globalThis.Error("unknown map entry field for field Yarn.Program.initial_values")}}e[null!=i?i:""]=null!=s?s:t.Operand.create()}internalBinaryWrite(e,n,s){""!==e.name&&n.tag(1,r.WireType.LengthDelimited).string(e.name);for(let i of Object.keys(e.nodes))n.tag(2,r.WireType.LengthDelimited).fork().tag(1,r.WireType.LengthDelimited).string(i),n.tag(2,r.WireType.LengthDelimited).fork(),t.Node.internalBinaryWrite(e.nodes[i],n,s),n.join().join();for(let i of Object.keys(e.initialValues))n.tag(3,r.WireType.LengthDelimited).fork().tag(1,r.WireType.LengthDelimited).string(i),n.tag(2,r.WireType.LengthDelimited).fork(),t.Operand.internalBinaryWrite(e.initialValues[i],n,s),n.join().join();let o=s.writeUnknownFields;return!1!==o&&(1==o?i.UnknownFieldHandler.onWrite:o)(this.typeName,e,n),n}}t.Program=new u;class c extends a.MessageType{constructor(){super("Yarn.Node",[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"instructions",kind:"message",repeat:1,T:()=>t.Instruction},{no:3,name:"labels",kind:"map",K:9,V:{kind:"scalar",T:5}},{no:4,name:"tags",kind:"scalar",repeat:2,T:9},{no:5,name:"sourceTextStringID",kind:"scalar",T:9}])}create(e){const t={name:"",instructions:[],labels:{},tags:[],sourceTextStringID:""};return globalThis.Object.defineProperty(t,o.MESSAGE_TYPE,{enumerable:!1,value:this}),void 0!==e&&(0,s.reflectionMergePartial)(this,t,e),t}internalBinaryRead(e,n,r,s){let o=null!=s?s:this.create(),a=e.pos+n;for(;e.pos<a;){let[n,s]=e.tag();switch(n){case 1:o.name=e.string();break;case 2:o.instructions.push(t.Instruction.internalBinaryRead(e,e.uint32(),r));break;case 3:this.binaryReadMap3(o.labels,e,r);break;case 4:o.tags.push(e.string());break;case 5:o.sourceTextStringID=e.string();break;default:let a=r.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${n} (wire type ${s}) for ${this.typeName}`);let l=e.skip(s);!1!==a&&(!0===a?i.UnknownFieldHandler.onRead:a)(this.typeName,o,n,s,l)}}return o}binaryReadMap3(e,t,n){let r,i,s=t.uint32(),o=t.pos+s;for(;t.pos<o;){let[e,n]=t.tag();switch(e){case 1:r=t.string();break;case 2:i=t.int32();break;default:throw new globalThis.Error("unknown map entry field for field Yarn.Node.labels")}}e[null!=r?r:""]=null!=i?i:0}internalBinaryWrite(e,n,s){""!==e.name&&n.tag(1,r.WireType.LengthDelimited).string(e.name);for(let i=0;i<e.instructions.length;i++)t.Instruction.internalBinaryWrite(e.instructions[i],n.tag(2,r.WireType.LengthDelimited).fork(),s).join();for(let t of Object.keys(e.labels))n.tag(3,r.WireType.LengthDelimited).fork().tag(1,r.WireType.LengthDelimited).string(t).tag(2,r.WireType.Varint).int32(e.labels[t]).join();for(let t=0;t<e.tags.length;t++)n.tag(4,r.WireType.LengthDelimited).string(e.tags[t]);""!==e.sourceTextStringID&&n.tag(5,r.WireType.LengthDelimited).string(e.sourceTextStringID);let o=s.writeUnknownFields;return!1!==o&&(1==o?i.UnknownFieldHandler.onWrite:o)(this.typeName,e,n),n}}t.Node=new c;class f extends a.MessageType{constructor(){super("Yarn.Instruction",[{no:1,name:"opcode",kind:"enum",T:()=>["Yarn.Instruction.OpCode",l]},{no:2,name:"operands",kind:"message",repeat:1,T:()=>t.Operand}])}create(e){const t={opcode:0,operands:[]};return globalThis.Object.defineProperty(t,o.MESSAGE_TYPE,{enumerable:!1,value:this}),void 0!==e&&(0,s.reflectionMergePartial)(this,t,e),t}internalBinaryRead(e,n,r,s){let o=null!=s?s:this.create(),a=e.pos+n;for(;e.pos<a;){let[n,s]=e.tag();switch(n){case 1:o.opcode=e.int32();break;case 2:o.operands.push(t.Operand.internalBinaryRead(e,e.uint32(),r));break;default:let a=r.readUnknownField;if("throw"===a)throw new globalThis.Error(`Unknown field ${n} (wire type ${s}) for ${this.typeName}`);let l=e.skip(s);!1!==a&&(!0===a?i.UnknownFieldHandler.onRead:a)(this.typeName,o,n,s,l)}}return o}internalBinaryWrite(e,n,s){0!==e.opcode&&n.tag(1,r.WireType.Varint).int32(e.opcode);for(let i=0;i<e.operands.length;i++)t.Operand.internalBinaryWrite(e.operands[i],n.tag(2,r.WireType.LengthDelimited).fork(),s).join();let o=s.writeUnknownFields;return!1!==o&&(1==o?i.UnknownFieldHandler.onWrite:o)(this.typeName,e,n),n}}t.Instruction=new f;class h extends a.MessageType{constructor(){super("Yarn.Operand",[{no:1,name:"string_value",kind:"scalar",oneof:"value",T:9},{no:2,name:"bool_value",kind:"scalar",oneof:"value",T:8},{no:3,name:"float_value",kind:"scalar",oneof:"value",T:2}])}create(e){const t={value:{oneofKind:void 0}};return globalThis.Object.defineProperty(t,o.MESSAGE_TYPE,{enumerable:!1,value:this}),void 0!==e&&(0,s.reflectionMergePartial)(this,t,e),t}internalBinaryRead(e,t,n,r){let s=null!=r?r:this.create(),o=e.pos+t;for(;e.pos<o;){let[t,r]=e.tag();switch(t){case 1:s.value={oneofKind:"stringValue",stringValue:e.string()};break;case 2:s.value={oneofKind:"boolValue",boolValue:e.bool()};break;case 3:s.value={oneofKind:"floatValue",floatValue:e.float()};break;default:let o=n.readUnknownField;if("throw"===o)throw new globalThis.Error(`Unknown field ${t} (wire type ${r}) for ${this.typeName}`);let a=e.skip(r);!1!==o&&(!0===o?i.UnknownFieldHandler.onRead:o)(this.typeName,s,t,r,a)}}return s}internalBinaryWrite(e,t,n){"stringValue"===e.value.oneofKind&&t.tag(1,r.WireType.LengthDelimited).string(e.value.stringValue),"boolValue"===e.value.oneofKind&&t.tag(2,r.WireType.Varint).bool(e.value.boolValue),"floatValue"===e.value.oneofKind&&t.tag(3,r.WireType.Bit32).float(e.value.floatValue);let s=n.writeUnknownFields;return!1!==s&&(1==s?i.UnknownFieldHandler.onWrite:s)(this.typeName,e,t),t}}t.Operand=new h},683:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.YarnVM=void 0;const r=n(137);var i;!function(e){e[e.Stopped=0]="Stopped",e[e.WaitingOnOptionSelection=1]="WaitingOnOptionSelection",e[e.WatingForContinue=2]="WatingForContinue",e[e.Running=3]="Running"}(i||(i={})),t.YarnVM=class{constructor(e,t){this.currentNode=null,this.stack=[],this.state=i.Stopped,this.programCounter=0,this.variableStorage={},this.optionSet=[],this.verboseLogging=!1,this.lineCallback=null,this.commandCallback=null,this.optionCallback=null,this.program=e,this.stringTable=t;for(let e in this.program.initialValues){let t=this.unwrap(this.program.initialValues[e]);null!=t&&(this.variableStorage[e]=t)}}resetState(){this.log("resetting state"),this.stack=[],this.programCounter=0,this.optionSet=[]}setNode(e){var t=this.program.nodes[e];return null!=t&&(this.resetState(),this.currentNode=t,!0)}stop(){this.log("stopping all execution"),this.state=i.Stopped,this.resetState()}selectOption(e){if(this.log("selecting option number: "+e),this.state!=i.WaitingOnOptionSelection)return void this.logError("asked to select option when options are not awaited");if(e<0||e>=this.optionSet.length)return void this.logError("asked to select an option beyond our comprehension");let t=this.optionSet[e].jump;this.stack.push(t),this.optionSet=[],this.state=i.WatingForContinue}start(){null!=this.currentNode?(this.log("starting the dialogue"),this.state=i.Running,this.continue()):this.logError("unable to start dialogue, have no node")}continue(){if(this.log("continuing"),null!=this.currentNode)for(;this.state==i.Running;)this.runInstruction(this.currentNode.instructions[this.programCounter]),this.programCounter+=1,this.programCounter>=this.currentNode.instructions.length&&(this.state=i.Stopped,this.log("node complete"));else this.log("unable to continue, node is null")}findInstructionPointForLabel(e){if(this.log(`looking for ${e}`),null==this.currentNode)return this.log(`unable to find jump point for ${e}, node is null`),null;let t=this.currentNode.labels[e];return null==t?(this.log(`unable to find jump point for ${e}, key does not exist`),null):t}runInstruction(e){var t;switch(e.opcode){case r.Instruction_OpCode.RUN_LINE:{let t=this.unwrapString(e.operands[0]);if(null!=t){this.log("running line "+t);var n=[];if(e.operands.length>1){let t=this.unwrapNumber(e.operands[1]);if(null!=t&&t>0)for(var s=t-1;s>=0;s--){let e=this.stack.pop();if(null==e){this.logError("asked to pop values from stack for inserting into lines, but stack has none!");break}n.push(e)}}let r=this.buildLine(t,n);this.state=i.WatingForContinue,null!=this.lineCallback&&this.lineCallback(r).then((e=>{this.state=i.Running,this.continue()}))}else this.logError("unable to run line, label is not a string");break}case r.Instruction_OpCode.RUN_COMMAND:var o=this.unwrapString(e.operands[0]);if(null==o&&(o="UNDEFINED"),this.log("running command: <<"+o+">>"),n=[],e.operands.length>1){let t=this.unwrapNumber(e.operands[1]);if(null!=t)for(s=t-1;s>=0;s--){let e=this.stack.pop();if(null==e){this.logError("asked to pop values from stack for inserting into commands, but stack has none!");break}n.push(e)}}o=this.buildCommand(o,n),this.state=i.WatingForContinue,null!=this.commandCallback&&this.commandCallback(o).then((e=>{this.state=i.Running,this.continue()}));break;case r.Instruction_OpCode.RUN_NODE:{this.log(`finished with ${null===(t=this.currentNode)||void 0===t?void 0:t.name}`);let e=this.stack.pop();if("string"==typeof e){if(!this.setNode(e)){this.logError(`unable to find ${e}`);break}this.log(`found ${e}`)}this.programCounter-=1,this.state=i.Running;break}case r.Instruction_OpCode.ADD_OPTION:{this.log("adding option");let t=this.unwrapString(e.operands[0]);if(null==t){this.logError("unable to run line, label is not a string");break}if(n=[],e.operands.length>2){let t=this.unwrapNumber(e.operands[2]);if(null!=t)for(s=t-1;s>=0;s--){let e=this.stack.pop();null!=e&&n.push(e)}}var a=this.unwrapString(e.operands[1]),l=!0;if(e.operands.length>3){var u=this.unwrapBool(e.operands[3]);null!=u&&1==u&&"boolean"==typeof(c=this.stack.pop())&&(l=c)}this.log(`adding option ${t}:${l}`);let r={label:t,line:l?this.buildLine(t,n):`${this.buildLine(t,n)} [disabled]`,jump:null==a?"":a,lineCondition:l};this.optionSet.push(r);break}case r.Instruction_OpCode.SHOW_OPTIONS:if(0==this.optionSet.length){this.logError("asked to show options but have none"),this.state,i.Stopped;break}this.log(`presenting ${this.optionSet.length} options`),this.state=i.WaitingOnOptionSelection,null!=this.optionCallback&&this.optionCallback(this.optionSet).then((e=>{this.selectOption(e),this.state=i.Running,this.continue()}));break;case r.Instruction_OpCode.POP:this.stack.pop();break;case r.Instruction_OpCode.PUSH_STRING:{let t=this.unwrapString(e.operands[0]);null!=t&&this.stack.push(t);break}case r.Instruction_OpCode.PUSH_BOOL:{let t=this.unwrapBool(e.operands[0]);null!=t&&this.stack.push(t);break}case r.Instruction_OpCode.PUSH_FLOAT:{let t=this.unwrapNumber(e.operands[0]);null!=t?this.stack.push(t):this.logError(`unable to unwrap operand ${e.operands[0]} into a number!`);break}case r.Instruction_OpCode.PUSH_NULL:this.logError("pushing null is no longer supported!");break;case r.Instruction_OpCode.PUSH_VARIABLE:{let t=this.unwrapString(e.operands[0]);if(null!=t){let e=this.variableStorage[t];null!=e&&this.stack.push(e)}break}case r.Instruction_OpCode.STORE_VARIABLE:{let t=this.unwrapString(e.operands[0]),n=this.top;null!=t&&(this.variableStorage[t]=n);break}case r.Instruction_OpCode.JUMP_TO:{let t=this.unwrapString(e.operands[0]);if(null!=t){let e=this.findInstructionPointForLabel(t);null==e?this.logError(`error jumping to ${t}, jump point not found`):this.programCounter=e-1}break}case r.Instruction_OpCode.JUMP_IF_FALSE:{let t=this.top;if("boolean"==typeof t&&!t){let t=this.unwrapString(e.operands[0]);if(null!=t){let e=this.findInstructionPointForLabel(t);null!=e&&(this.programCounter=e-1)}}break}case r.Instruction_OpCode.JUMP:{let e=this.top;if("string"==typeof e){let t=this.findInstructionPointForLabel(e);null!=t&&(this.programCounter=t-1)}break}case r.Instruction_OpCode.CALL_FUNC:{let t=this.stack.pop();if(null!=t&&"number"==typeof t){for(n=[],s=0;s<t;s++){var c;null!=(c=this.stack.pop())&&n.push(c)}let r=this.unwrapString(e.operands[0]);if(null!=r){let e=this.runFunc(r,n);null!=e?this.stack.push(e):this.logError(`${r} did not return a valid result`)}}else this.logError("top of stack is not a number!");break}case r.Instruction_OpCode.STOP:this.state=i.Stopped;break;default:this.logError(`Unknown opcode: ${e.opcode}`),this.state=i.Stopped}}runFunc(e,t){if(e.startsWith("Number.")){if(e=e.substring(7),"number"!=typeof t[0])return void this.logError("asked to perform a number function but the first param is not a number!");let n=t[0];if("UnaryMinus"==e)return-1*n;if("number"!=typeof t[1])return void this.logError(`asked to perform a number function: ${e} but the second param is not a number, its a ${typeof t[1]} (${t[1]})`);let r=t[1];switch(e){case"Add":return n+r;case"Minus":return r-n;case"Multiply":return n*r;case"Divide":return r/n;case"Modulo":return r%n;case"EqualTo":return n==r;case"GreaterThan":return r>n;case"GreaterThanOrEqualTo":return r>=n;case"LessThan":return r<n;case"LessThanOrEqualTo":return r<=n;case"NotEqualTo":return n!=r}}if(e.startsWith("Bool.")){if(e=e.substring(5),"boolean"!=typeof t[0])return void this.logError("asked to perform a boolean operation but don't have a bool");let n=t[0];if("Not"==e)return!n;if("boolean"!=typeof t[1])return void this.logError("parameter 2 is not a boolean!");let r=t[1];switch(e){case"EqualTo":return n==r;case"NotEqualTo":case"Xor":return n!=r;case"Or":return n||r;case"And":return n&&r}}if(e.startsWith("String.")){if(e=e.substring(7),"string"!=typeof t[0]||"string"!=typeof t[1])return void this.logError("asked to perform a string function but parameters are not strings!");let n=t[0],r=t[1];switch(e){case"EqualTo":return n==r;case"NotEqualTo":return n!=r;case"Add":return r+n}}if("number"==e&&null!=t[0])switch(typeof t[0]){case"string":return parseFloat(t[0]);case"boolean":return t[0]?1:0;case"number":return t[0]}if("string"==e&&null!=t[0])return`${t[0]}`;if("bool"==e&&null!=t[0])switch(typeof t[0]){case"boolean":return t[0];case"number":return t[0]>=1;case"string":return"true"==t[0]}if(("visited"==e||"visited_count"==e)&&"string"==typeof t[0]){let r=`$Yarn.Internal.Visiting.${t[0]}`;var n=this.variableStorage[r];return this.log(`visiting ${r}: ${n}`),"number"!=typeof n&&(n=0),"visited_count"==e?n:n>0}switch(e){case"random":return Math.random();case"random_range":if("number"==typeof t[0]&&"number"==typeof t[1]){let e,n;return t[0]>t[1]?(e=t[1],n=t[0]):(e=t[0],n=t[1]),this.randomRange(e,n)}break;case"dice":if("number"==typeof t[0]&&t[0]>1)return this.randomRange(1,t[0]);break;case"round":if("number"==typeof t[0])return Math.round(t[0]);break;case"round_places":if("number"==typeof t[0]&&"number"==typeof t[1])return+t[0].toFixed(t[1]);break;case"floor":if("number"==typeof t[0])return Math.floor(t[0]);break;case"ceil":if("number"==typeof t[0])return Math.ceil(t[0]);break;case"inc":if("number"==typeof t[0])return Math.round(t[0])+1;break;case"dec":if("number"==typeof t[0])return Math.round(t[0])-1;break;case"decimal":if("number"==typeof t[0])return t[0]%1;break;case"int":if("number"==typeof t[0])return Math.trunc(t[0])}switch(e){case"dummy_number":return 1;case"dummy_bool":return!0;case"dummy_string":return"string"}this.logError(`Encountered invalid function: ${e} with parameters: (${t})`)}randomRange(e,t){return Math.floor(Math.random()*(t-e+1))+e}buildLine(e,t){var n=this.stringTable[e];if(null==n)return e;for(var r in t){let e=t[r];"boolean"==typeof e?n=n.replace("{"+r+"}",1==e?"True":"False"):("number"==typeof e&&(Number.isInteger(e)||(e=e.toFixed(1))),n=n.replace("{"+r+"}",`${e}`))}return n}buildCommand(e,t){var n=e;for(var r in t){let e=t[r];n="boolean"==typeof e?n.replace("{"+r+"}",1==e?"True":"False"):n.replace("{"+r+"}",`${e}`)}return n}unwrap(e){switch(e.value.oneofKind){case"boolValue":return e.value.boolValue;case"floatValue":return e.value.floatValue;case"stringValue":return e.value.stringValue}}unwrapString(e){if("stringValue"===e.value.oneofKind)return e.value.stringValue}unwrapBool(e){if("boolValue"===e.value.oneofKind)return e.value.boolValue}unwrapNumber(e){if("floatValue"===e.value.oneofKind)return e.value.floatValue}log(e){this.verboseLogging&&console.log(e)}logError(e){console.error(e)}get top(){return this.stack[this.stack.length-1]}printInstruction(e){var t=`${r.Instruction_OpCode[e.opcode]}: `;return null==e.operands||null==e.operands||0==e.operands.length?t+="no parameters":e.operands.forEach((e=>{t+=`${this.unwrap(e)}, `})),t}printAllInstructions(){for(var e in console.log("Printing all instructions"),this.program.nodes)for(var t of(console.log(`${e}:`),this.program.nodes[e].instructions))console.log(this.printInstruction(t))}}}},e=>{e(e.s=138)}]);